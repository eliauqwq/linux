# 文件与目录命令——awk。
awk是linux中一种文本处理工具，它能按行扫描文件并且经过特定操作筛选处理之后输出结果。
在awk中，临时变量都是初始化完成的，可以直接使用。

## awk的基本语法结构
```
awk -[选项] '前置条件 {具体操作}' [文件名]
```

*前置条件*：判断实行操作所需条件，可以是空
*具体操作*：对文件的具体操作。

## awk的常用选项
在awk中，有下面两种选项进场被用到：

`-F`：分隔符设定，作为划分列与列的标志，默认是空格或者制表符。

`-v`：引入变量，通常为后面前置条件传入变量。

## awk中的内置变量
在awk命令中，有不少内置变量，方便我们对目标文件进行操作。
- `$0`：通常代表当前行的所有文本。
- `$1`...`$n`：代表当前行的第n段文本，也就是第几列。
- `NR`：对应**number of record**，也就是当前记录的行号。
- `NF`：对应**number of field**,也就是当前行的段数。

## awk的常见操作
**1. 输出当前文件**：
```
awk '{print $0}' file
```
print操作是打印，而$0指的是当前行所有文本，而awk是按行扫描，按行输出该行的所有文本，也就是输出
整个文件。

**2. 指定分隔符打印指定段**：
```
awk -F ',' '{print $2}' file
```
打印file中以逗号为分隔符的每行第二段，也就是整个文件的第二列。

**3. 条件判断打印符合行**：
```
awk '$2 == "Tom" {print $0}' file
```
打印所有第二列是Tom的整行。***需要注意的是，awk偏向符合c++的逻辑判断，因此等于使用两个等号，而不是想shell中用单等于号来表示相等逻辑***。

**4. 打印整行和行号**
```
awk '{print NR,$0}' file
```
打印每行内容及其行号。

**5. 统计字段数量**
```
awk '{print NF}' file
```
分别输出每行的段数。

**6. END后置结束操作**
```
awk '{sum += NF} END {print sum}' file
```
这里先计算每行段数的和，操作结束后再打印出和。
***该操作是可以叠加的，但是遍历文件每一行只出现在第一个操作，后续每个操作只针对最后一行。*** 例如：
```
awk '{print $0} END {print $0}' file
```
这个命令会输出file整个文件内容一次，再单独输出file的最后一行内容。

**7. 收取外部变量**
```
awk -v standard=$find '$2 > standard {print $0}' file
```
从awk脚本外截取find变量的值给awk，再根据条件判断输出的行。
***standard已经作为awk变量传入awk了，因此在 '...'内再使用不需要取值符'$'。***

**8. 正则表达式**
```
awk '/error/{print $0}' file
```
打印所有符合error的行。***在awk中，使用正则表达式需要用/包起来***。